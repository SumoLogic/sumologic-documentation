---
id: elastic-load-balancing-classic
title: AWS Elastic Load Balancer - Classic
description: Distributes incoming application traffic across multiple Amazon EC2 instances in the AWS Cloud.
---

import useBaseUrl from '@docusaurus/useBaseUrl';

<img src={useBaseUrl('img/integrations/amazon-aws/elb-classic.png')} alt="Thumbnail icon" width="50"/>

The Amazon Web Services (AWS) Elastic Load Balancer - Classic distributes incoming application traffic across multiple Amazon EC2 instances in the AWS Cloud. The Sumo Logic App for Elastic Load Balancer - Classic ingests logs generated by this activity, providing greater visibility into events that, in turn, help you understand the overall health of your EC2 deployment.

For example, you can use the Sumo Logic App to analyze raw Elastic Load Balancing data to investigate the availability of applications running behind Elastic Load Balancers. Or, by correlating Elastic Load Balancer data with other data sets, you can get a broader understanding of the fault tolerance of your applications across multiple AWS Availability Zones.

If you are just beginning with AWS ELB, for background see the Sumo Logic DevOps blog, ["AWS Elastic Load Balancing: Load Balancer Best Practices"](https://www.sumologic.com/blog-devops/aws-elastic-load-balancer-best-practices/).

## Log Types

ELB logs are stored as .log files in the buckets you specify when you enable logging.

The process to enable collection for these logs is described in [AWS ELB Enable Access Logs](http://docs.aws.amazon.com/elasticloadbalancing/latest/classic/enable-access-logs.html).

The logs themselves contain these fields in this order:
```
datetime, ELB_Server, clientIP, port, backend, \
backend_port, requestProc, ba_Response, cli_Response, \
ELB_StatusCode, be_StatusCode, rcvd, send, method, \
protocol, domain, server_port, path
```
The log format is described in [AWS ELB Access Log Collection](http://docs.aws.amazon.com/elasticloadbalancing/latest/classic/access-log-collection.html). For information on unified logs and metrics for AWS Elastic Load Balancing - Classic, see [AWS Elastic Load Balancing ULM - Classic](/docs/integrations/amazon-aws/classic-load-balancer).

## Prerequisites

Follow the [Before you begin](#Before-you-begin) section and then use the in-product instructions in Sumo Logic to set up the app. For information on collecting unified logs and metrics for AWS Elastic Load Balancing - Classic, see [AWS Elastic Load Balancing ULM - Classic](/docs/integrations/amazon-aws/classic-load-balancer.md).


### Before you begin

Enable Elastic Load Balancing logging in your AWS account and configure a Sumo Logic ELB Source, using [these instructions](/docs/send-data/hosted-collectors/amazon-aws/aws-elastic-load-balancing-source).

If you have more than one environment that generates Elastic Load Balancing data (such as ops, dev, and so on), you’ll need to configure a separate S3 Source for each environment. This means that you’ll have the three App Dashboards for each environment. To avoid confusion, and in order to identify which environment is generating data, you should name each S3 Source with the environment's name. For example, you might name Sources as ELB-prod, ELB-dev, ELB-test, and so on.

Finally, make copies of each Panel in the Elastic Load Balancing Dashboards, and modify the search logic in each Panel so that you select the appropriate source for each environment. For example, for a production environment, you will add the string `_source=ELB-production` to the beginning of each search. If you have three environments then you will have three copies of the application for each of them (nine dashboards in total).


## Collecting Logs for the AWS Elastic Load Balancing - Classic App

This procedure shows how to enable access to your Amazon Web Services (AWS) Elastic Load Balancing (ELB) logs and ingest them into Sumo Logic.

:::note
Once you begin uploading data, your daily data usage will increase. It's a good idea to check the **Account** page in Sumo Logic to make sure that you have enough quota to accommodate additional data in your account. If you need additional quota you can [upgrade your account](/docs/manage/manage-subscription/upgrade-cloud-flex-account.md) at any time.
:::


### Configure a Collector

Configure a [Hosted Collector](/docs/send-data/hosted-collectors/configure-hosted-collector).


### Configure an ELB Source

import Aws3 from '../../reuse/apps/create-aws-s3-source.md';

<Aws3/>

### Field Extraction Rules

For Field Extraction Rules, use the source category established earlier.

```bash title="AWS Elastic Load Balancing Logs"
parse "* * *:* *:* * * * * * * * \"* *://*:*/* HTTP" as datetime, ELB_Server, clientIP, port, backend, backend_port, requestProc, ba_Response, cli_Response, ELB_StatusCode, be_StatusCode, rcvd, send, method, protocol, domain, server_port, path
```


### Sample Log Message

```json
2017-01-20T23:00:26.059475Z elb-shop-com 10.15.120.181:80 10.34.7.122:80 0.000026
0.315185 0.000027 200 200 51 1230 "POST https://examplesite.com:443/Common/path HTTP/1.1"
"Mozilla/5.0 (Safari; Touch) AppleWebKit/537.35+ (HTML, like Gecko) Version/10.3.2.2239
Mobile Safari/517.35+"
```

### Sample Query

```sql title="Name - Request by Geolocation"
_sourceCategory=elb*
| parse "* * *:* *:* * * * * * * * \"* *://*:*/* HTTP" as f1, elb_server, clientIP, port, backend, backend_port, requestProc, ba_Response, cli_Response, ELB_StatusCode, be_StatusCode, rcvd, send, method, protocol, domain, server_port, path nodrop
| parse "* * *:* *:* * * * * * * * \"-" as f1,elb_server,clientIP,port,backend,backend_port,requestProc,ba_Response,cli_Response,ELB_StatusCode,be_StatusCode,rcvd,send
| lookup latitude, longitude, country_code, country_name, region, city, postal_code, area_code, metro_code from geo://default on ip = clientIP
| count by latitude, longitude, country_code, country_name, region, city, postal_code, area_code, metro_code
| sort _count
```

## Installing the AWS Elastic Load Balancer Classic App

Now that you have set up collection for AWS ELB, install the Sumo Logic App for AWS Elastic Load Balancer - Classic to use the preconfigured searches and dashboards to analyze your data.

import AppInstall from '../../reuse/apps/app-install.md';

<AppInstall/>

<details>
<summary>What if data isn't displaying in all Panels?</summary>

Amazon S3 buckets are scanned for new files according to the Scan Interval you set when configuring the S3 Source used for AWS Elastic Load Balancing logs. Even if you set a shorter Scan Interval, say five minutes, if no new files are found, the Scan Interval is automatically doubled, up to 24 hours (you can read more in [Set the S3 Source Scan Interval](/docs/send-data/hosted-collectors/amazon-aws/aws-s3-scan-interval-sources)). If the Scan Interval increases, it means that a Panel set to a 60-minute time range may not find any data to display, because no files have uploaded to Sumo Logic. This isn't to say that no data is being collected from your S3 bucket; you can confirm that data is being collected on the Status page.

Additionally, you can change the time range of a Panel. Even though these Panels have been preconfigured, they can be edited just like any other Panel. You'll find instructions in Changing the time range of a Panel.

</details>

## Viewing the AWS Elastic Load Balancer Classic Dashboards

The Sumo Logic App for AWS Elastic Load Balancing helps you monitor the overall health of your ELB deployment. Dashboards keep an eye on errors being generated by back-end applications as well as errors generated from ELB instances.


### Overview

Track your Elastic Load Balancer activity at a glance to identify areas for further investigation such as requests by geolocation, browsers most frequently used, requests by protocol and cipher, which load balancers make the most requests, data sent and received, status codes, response times, and latencies.

* **Requests by Geolocation.** Uses a geolocation query to display a map of the IP addresses used by clients accessing your apps for the last three hours.
* **Browsers and Operating Systems.** See requests by browser used, broken down by  operating system for the last three hours.
* **Requests by SSL Protocol and Cipher. **See which version of TSL or SSL is being used by requests, broken down by which cryptographic cipher was used for the last three hours.
* **Requests by Load Balancer.** See how many requests are hitting a load balancer for the last three hours.
* **Data Sent and Received in MB. **Compare the data being sent and received by client IP in a bar chart for the last three hours.
* **4XX and 5XX Status Codes by Backend Instance and ELB.** Charts the number of 4XX and 5XX status codes for each backend instance and ELB in a bar chart over the last 24 hours.
* **Average Req and Resp Processing Time by ELB.** Compare the request and response time for each ELB for the last three hours.
* **Latency by Load Balancer.** See the latency of each load balancer in AWS in a stacked column chart for the last three hours.

<img src={useBaseUrl('img/integrations/amazon-aws/AWS-ELB-Classic-Overview.png')} alt="AWS Elastic Load Balancer Classic" />

### Latency Analysis

* **Definitions Panel. **Understand the definitions of request, response, and backend processing times. You can close this panel once you have a good grasp of the terms defined.
* **Latency by Domain.** See the latency of each domain in your EC2 deployment for the last 24 hours.
* **Total Processing TIme Latency 90th, 95th pct. **Compare the highest latencies by percentile over the last 24 hours.
* **Latency by ELB Server. **Compare the latencies of ELB servers over the last 24 hours.
* **Average Request Processing Time by ELB Server.** Compare the average request processing times of ELB servers as a line chart for the last 24 hours.
* **Request Processing Time by ELB Server.** See the min, max, and average request processing times for each server for the last 24 hours as a bar chart.
* **Average Response Processing Time by ELB Server.** See the average response processing time for each ELB server for the last 24 hours as a line chart.
* **Response Processing Time by ELB Server. ** See the min, max, and average request processing times for each server for the last 24 hours as a bar chart.
* **Average Backend Processing Time by Backend.** Compare average processing times by backend servers over the last 24 hours to find any unusual spikes of activity on a particular backend.
* **Backend Processing Time by Backend.** View the average, min, and max processing times for your backend systems for the last 24 hours, broken down by backends.
* **Top 20 Latencies Paths.** View the paths of the top 20 latencies in your system for the last 3 hours.
* **Top 20 Latencies by Clients.** View the IP addresses of the clients in your deployment with the top 20 latencies in the last 24 hours.
* **Top 20 Latencies by Backend Instances.** Focus solely on the back end of your Amazon EC2 deployment, review the instances with the top 20 latencies for the last 24 hours

<img src={useBaseUrl('img/integrations/amazon-aws/AWS-ELB-Classic-Latency-Analysis.png')} alt="AWS Elastic Load Balancer Classic" />

### Requests Analysis

See the geolocation of requests by geolocation, data volume, load balancer, and compare to requests over time to identify issues.

* **Requests by Geolocation.** Uses a geolocation query to display a map of the IP addresses used by clients accessing your apps for the last three hours.
* **Total Requests and Data Volume.** Displays the data being sent and received by client IP in a line chart on a timeline for the last three hours.
* **Total Requests by Load Balancer.** Show the requests per load balancer over time in a bar chart for the last three hours.
* **Requests by Load Balancer Over Time.** Displays a line chart of how many requests are hitting a load balancer on a timeline over the last 24 hours.

<img src={useBaseUrl('img/integrations/amazon-aws/AWS-ELB-Classic-Request-Analysis.png')} alt="AWS Elastic Load Balancer Classic" />

### Status Codes Analysis

* **ELB Status Over Time.** Compare 4xx and 5xx ELB status codes over the last 24 hours.
* **ELB Backend Status Over Time.** Compare 4xx and 5xx backend status codes over the last 24 hours.
* **4XX ELB Status by Location.** See the geolocation of your ELB 4xx statuses over the last 24 hours.
* **5XX ELB Status by Location. **See the geolocation of your ELB 5xx statuses over the last 24 hours.
* **4XX Backend Status by Location.** See the geolocation of your backend 4xx statuses over the last 24 hours.
* **5XX ELB Status by Location.** See the geolocation of your backend 5xx status codes over the last 24 hours.
* **ELB Status by ELB Server.** Compare the 4xx and 5xx codes of your ELB servers for the last 24 hours with a bar chart.
* **Backend Status by Domain.** Compare the number of backend 4xx and 5xx statuses over the last 24 hours by domain name.
* **Backend Status by Path.** Compare the number of backend 4xx and 5xx statuses over the last 24 hours by path name.
* **ELB Status by Client.** Compare the number of ELB 4xx and 5xx statuses by client IP address over the last 24 hours.
* **Backend Status by Client.** Compare the number of backend 4xx and 5xx statuses by client.

<img src={useBaseUrl('img/integrations/amazon-aws/AWS-ELB-Classic-Status-Codes-Analysis.png')} alt="AWS Elastic Load Balancer Classic" />



### Failed Dispatch Monitoring

See failed dispatches broken down by geolocation, outliers, backend, count, client, path, and domain to identify issues.

* **Failed Dispatches.** Read this informational panel on what failure means. You can close it when you understand the reasons for -1.
* **Failed Dispatch Outlier.** See if any dispatch failures fall outside the designated threshold for the last 24 hours.
* **Failed Dispatches by Backend.** See the dispatch failures that occur by backend IP address for the last 24 hours, time sliced by 15 minutes. This panel can help you isolate a failure at a particular time or see patterns over time.
* **Failed Dispatch Count. **See a count of the total failed dispatches over the last 24 hours time sliced by 15 minutes.
* **Failed Dispatches by Client.** See the count of total dispatch failures for the last 24 hours broken down by client IP address.
* **Failed Dispatches by Domain.** See the failed dispatches for the last 24 hours broken down by domain and time sliced by 15 minutes. This panel can help you isolate a failure at a particular time or see patterns over time.

<img src={useBaseUrl('img/integrations/amazon-aws/AWS-ELB-Classic-Failed-Dispatch-Monitoring.png')} alt="AWS Elastic Load Balancer Classic" />
