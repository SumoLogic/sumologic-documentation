---
id: microsoft-defender-for-office-365
title: Microsoft Defender for Office 365
sidebar_label: Microsoft Defender for Office 365
description: The Sumo Logic App for Microsoft Defender for Office 365 outlines the steps required to collect and analyze the alert data from the Azure security platform to the Sumo Logic platform.
---

import useBaseUrl from '@docusaurus/useBaseUrl';

<img src={useBaseUrl('img/integrations/microsoft-azure/microsoft-defender-office-365.png')} alt="Thumbnail icon" width="40"/>

Microsoft Defender for Office 365 is a cloud-based email security service designed to protect your organization using Microsoft 365 (formerly Office 365) against threats such as:
- Phishing
- Malware
- Ransomware
- Business Email Compromise (BEC)
- Zero-day threats

This document outlines the steps required to collect and analyse the [Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/mdo-about) alerts in the Sumo Logic platform.

## Set up collection

:::note
Skip this step if you have already configured the Microsoft Graph Security API Source.
:::

Use theÂ [Cloud-to-Cloud Integration for Microsoft Graph Security API](/docs/send-data/hosted-collectors/cloud-to-cloud-integration-framework/microsoft-graph-security-api-source/) to ingest security alerts data from the Microsoft Defender for Office 365 to the Sumo Logic platform.

## Search alerts

Use the following query to retrieve alerts generated by the Microsoft Defender for Office 365.

```sql
_sourcecategory=Labs/MicrosoftGraphSecurity
| json field=_raw "serviceSource" as service_source
| where service_source = "microsoftDefenderForOffice365"
```

## Analyse alerts

Use the following query to extract detailed insights from the alert data:

```sql
_sourceCategory=Labs/MicrosoftGraphSecurity  
|json"id","status","severity","category","title","description","classification","determination","serviceSource","detectionSource","alertWebUrl" ,"comments[*]","evidence[*]"as  alert_id,status,severity,category,title,description,classification,determination,service_source,detection_source,alert_url,comments,evidence_info nodrop
| where service_source = "microsoftDefenderForOffice365"
| where severity matches "*" and status matches "*" and classification matches "*" 
| if(isNull(category),"-",category) as category
| if(isNull(classification),"-",classification) as classification
| if(isNull(determination),"-",determination) as determination
| count by _messageTime,status,severity,category,title,description,classification,determination,alert_url,alert_id
| formatDate(toLong(_messageTime), "dd-MM-yyyy HH:mm:ss") as time
| tourl (alert_url,alert_id) as alert_id
| fields time,alert_id,title,description,alert_url,status,severity,category,classification,determination
| fields -_messageTime    
| sort by time
```