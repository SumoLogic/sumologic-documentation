---
id: collect-with-lambda-function
title: Collect Amazon CloudWatch Logs using a Lambda Function
sidebar_label: Collect Logs using a Lambda Function
description: Learn how to collect Amazon CloudWatch Logs with a Lambda function.
---

The following instructions tell you to how download and configure an AWS Lambda function for Amazon CloudWatch Logs and send then to Sumo Logic.

:::caution
This method is highly not recommended as it does not handle failures and may lead to data loss. In addition, the data format generated by this method might be incompatible with some applications in the App catalog and thus requires customization of those apps.
:::

:::info
We strongly recommend the alternative collection process described on [AWS Kinesis Firehose for Logs Source](/docs/send-data/hosted-collectors/amazon-aws/aws-kinesis-firehose-logs-source/), which is more robust and reliable, where you do not need to manage resources. Lambda based collection methods are limited by time out, concurrency, and memory limits.
:::

## Add a Hosted Collector and HTTP Source

1. In Sumo Logic, configure a [Hosted Collector](/docs/send-data/hosted-collectors/configure-hosted-collector).
1. In Sumo Logic, configure an [HTTP Source](/docs/send-data/hosted-collectors/http-source/logs-metrics).

:::note
When you configure the HTTP Source, make sure to save the HTTP Source Address URL. You will need this to configure the Lambda Function.  
:::

## Create Lambda function

Sumo provides a Lambda function for use with Amazon Web Services (AWS). It collects AWS Lambda logs using CloudWatch Logs and it extracts and adds a `RequestId` field to each log line to make correlation easier. 

To add an Amazon Lambda function:

1. Sign in to the AWS Management Console.
1. Click **Lambda** in the **Compute** section.
1. On the AWS Lambda page, click **Create a Function**. 
1. On the **Blueprints** page, enter sumologic in the search field, and click the search icon.
1. Select sumologic-process-logs. The **Create Function** page appears.
1. In the **Basic information** page, enter the following.

    ![lambda4.png](/img/send-data/lambda4.png)

    * **Name**. Enter a name for the function.
    * **Role**. Choose one of the following options.
      * **Choose an existing role.** If you have any appropriate roles, you can select one.
      * **Create new role from template(s)**. If you select this option, you can continue without choosing any policy templates—it will create a role with basic Lambda execution privileges by default.
    * **Role Name**. Enter a name for the role.
    * **Policy templates**. If you selected **Create new role from template(s) above, you can leave this blank. 

1. In the **cloudwatch-logs** section, you can create a trigger now, or click **Remove** if you prefer to create it later. To create the trigger:

    ![trigger.png](/img/send-data/trigger.png)

    * **Log Group**. Select the log group that serves as the event source. Events sent to the log source will trigger your Lambda function. 
    * **Filter Name**. Enter a filter name.
    * **Filter Pattern**. May be left blank. For information about AWS filter patterns, see [Filter and Pattern Syntax](http://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/FilterAndPatternSyntax.html) in AWS help.
    * **Enable trigger**—Check the box to enable the trigger immediately. 
1. On the **Environment Variables** page, create a environment variable named SUMO_ENDPOINT. Set the value of the variable to the URL of the HTTP source to which your logs will be sent. In addition, you can set any of the following optional variables:

    ![lambda6.png](/img/send-data/lambda6.png)
    * **ENCODING (Optional)**. Use when decoding CloudWatch log events, default is **utf-1**.
    * **SOURCE_CATEGORY_OVERRIDE (Optional)**. Override `_sourceCategory` value configured for the HTTP source.  
    * **SOURCE_HOST_OVERRIDE (Optional)**. Override `_sourceHost` value configured for the HTTP source.
    * **SOURCE_NAME_OVERRIDE (Optional)**. Override `_sourceName` value configured for the HTTP source.
1. Click **Create Function.**

## Create a CloudWatch Log Group

You will need at least one CloudWatch Log Group to assign to your Lambda function. For details on how to create a CloudWatch Log Group, see [create a CloudWatch Log Group](http://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/Create-Log-Group.html).

### Assign CloudWatch Log Groups to Your Lambda Function

1. Go to the **Triggers** tab of your Lambda function.
1. Select **Add Trigger.**
1. In the **Add Trigger** prompt, click the box as instructed and select **CloudWatch Logs** from the dropdown menu.
1. Select a **CloudWatch Log Group** to add to your function. You need at least one CloudWatch Log Group to see this option. For details on creating a log group, see [create a CloudWatch Log Group](http://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/Create-Log-Group.html).
1. Add a **Filter Name** to your trigger.
1. (Optional) Add a **Filter Pattern** to your trigger. For information about AWS filter patterns, see [Filter and Pattern Syntax](http://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/FilterAndPatternSyntax.html) in the AWS documentation.
1. Click **Enable Trigger**.
1. Click **Submit** to add the trigger to your Lambda function.

:::note
If you have more than one CloudWatch Log Group to assign to your Lambda function, repeat the above steps for each Log Group.
:::
